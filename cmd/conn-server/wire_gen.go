// Code generated by Wire. DO NOT EDIT.

//go:generate go run -mod=mod github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package main

import (
	"Hyper/config"
	"Hyper/dao"
	"Hyper/dao/cache"
	"Hyper/pkg/client"
	"Hyper/pkg/database"
	"Hyper/pkg/rocketmq"
	socket2 "Hyper/pkg/socket"
	"Hyper/service"
	"Hyper/socket"
	"Hyper/socket/handler"
	"Hyper/socket/handler/event"
	"Hyper/socket/handler/event/chat"
	"Hyper/socket/process"
	"Hyper/socket/router"
)

// Injectors from wire.go:

func InitSocketServer(cfg *config.Config) *socket.AppProvider {
	redisClient := client.NewRedisClient(cfg)
	serverStorage := cache.NewSidStorage(redisClient)
	clientStorage := cache.NewClientStorage(redisClient, cfg, serverStorage)
	clientConnectService := &service.ClientConnectService{
		Storage: clientStorage,
	}
	db := database.NewDB(cfg)
	relation := cache.NewRelation(redisClient)
	groupMember := dao.NewGroupMember(db, relation)
	group := dao.NewGroup(db)
	sessionDAO := dao.NewSessionDAO(db)
	unreadStorage := cache.NewUnreadStorage(redisClient)
	groupMemberService := &service.GroupMemberService{
		Redis:          redisClient,
		GroupRepo:      group,
		Relation:       relation,
		DB:             db,
		GroupMemberDAO: groupMember,
		SessionDAO:     sessionDAO,
		UnreadStorage:  unreadStorage,
	}
	chatHandler := &chat.Handler{
		Redis: redisClient,
	}
	roomStorage := socket2.NewRoomStorage()
	chatEvent := &event.ChatEvent{
		Redis:           redisClient,
		GroupMemberRepo: groupMember,
		MemberService:   groupMemberService,
		Handler:         chatHandler,
		RoomStorage:     roomStorage,
	}
	chatChannel := &handler.ChatChannel{
		Storage: clientConnectService,
		Event:   chatEvent,
	}
	handlerHandler := &handler.Handler{
		Chat:        chatChannel,
		Config:      cfg,
		RoomStorage: roomStorage,
	}
	engine := router.NewRouter(cfg, handlerHandler)
	healthSubscribe := process.NewHealthSubscribe(serverStorage)
	messageDAO := dao.NewMessageDAO(db)
	users := dao.NewUsers(db)
	userService := &service.UserService{
		UsersRepo: users,
		Redis:     redisClient,
		DB:        db,
	}
	rocketMQConfig := config.ProvideRocketMQConfig(cfg)
	producer := rocketmq.InitProducer(rocketMQConfig)
	messageService := &service.MessageService{
		MessageDao:     messageDAO,
		UserService:    userService,
		GroupMemberDAO: groupMember,
		GroupDAO:       group,
		MqProducer:     producer,
		Redis:          redisClient,
		DB:             db,
	}
	messageStorage := cache.NewMessageStorage(redisClient)
	sessionService := &service.SessionService{
		DB:             db,
		MessageStorage: messageStorage,
		UnreadStorage:  unreadStorage,
		UserService:    userService,
		SessionDAO:     sessionDAO,
		GroupDAO:       group,
	}
	messageSubscribe := &process.MessageSubscribe{
		Redis:          redisClient,
		DB:             db,
		MessageService: messageService,
		MessageStorage: messageStorage,
		SessionService: sessionService,
		UnreadStorage:  unreadStorage,
		GroupMemberDAO: groupMember,
	}
	noticeSubscribe := &process.NoticeSubscribe{
		Redis:          redisClient,
		ConnectService: clientConnectService,
	}
	subServers := &process.SubServers{
		HealthSubscribe:  healthSubscribe,
		MessageSubscribe: messageSubscribe,
		NoticeSubscribe:  noticeSubscribe,
	}
	simpleConsumer := rocketmq.InitConsumer(rocketMQConfig)
	server := process.NewServer(subServers, simpleConsumer)
	appProvider := &socket.AppProvider{
		Config:    cfg,
		Engine:    engine,
		Coroutine: server,
		Handler:   handlerHandler,
	}
	return appProvider
}
